<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>LVE Repository</title>
        <link rel="stylesheet" href="/style.css">
        <meta name="description" content="LVE: We document and track vulnerabilities and exposures of large language models (LVEs).">
        <script src="/copy.js"></script>
        <script src="/instances.js"></script>
        <script src="/promptdown.dist.js"></script>
        <script src="/nav.js"></script>
        <link rel="stylesheet" href="/promptdown.css">
    
</head>
<body>
    <div class="toolbar">
    <div class="content">
        <a href="/index.html">
            <img class="logo" src="/lve.svg"/>
            <h1>LVE Repository</h1>
        </a>
        <div style="flex: 1"></div>
        <ul>
            <li> 
                <a href="/competitions">Competitions</a> 
            </li>
            <li>
                <a href="/docs">Docs</a>
            </li>
            <li class="small">
                <a href="https://discord.gg/Qgy3rqRx">
                    <img src="/discord.svg"/>
                </a>
            </li>
            <li class="small">
                <a href="https://github.com/lve-org/lve">
                    <img src="/github.png"/>
                </a>
            </li>
        </ul>
    </div>
</div>
    <div class="content docs with-sidebar">
        <div class='nav-dim' onclick='toggleNav()'></div><div class='mobile-nav'><a onclick='toggleNav()'>â˜° Menu</a></div><nav class='left'><ul>
            <li class="">
                <a href="/docs/index.html"> What is the LVE Project?</a>
            </li>
            <li class='header'>Contributing</li>
            <li class="">
                <a href="/docs/contributing/guidelines.html"> Guidelines</a>
            </li>
            
            <li class="">
                <a href="/docs/contributing/resources.html">Resources</a>
            </li>
            <li class='header'>Technical</li>
            <li class="active">
                <a href="/docs/technical/checker.html">Checker</a>
            </li>
            
            <li class="">
                <a href="/docs/technical/prompt.html">Prompt</a>
            </li>
            
            <li class="">
                <a href="/docs/technical/core_checkers.html">Core Checkers</a>
            </li>
            </ul></nav>
        <div class="markdown">
         <h1 id="checker">Checker</h1>
<p>A checker class provides a <code>is_safe</code> function that gets the prompt, model repose(s) and prompt parameters and determines whether an instance of the LVE is safe or not.</p>
<h2 id="available-checkers">Available Checkers</h2>
<p>The amiable checkers can be found in <a href="/docs/technical/core_checkers.html">Core Checkers</a>.</p>
<h2 id="post-processing">Post-Processing</h2>
<p>Checkers can specify a <code>postprocess_response</code> function that can alter the saved instance (either a response string or dictionary of variables) before saving it to a file. This should be used to avoid storing problematic information such as toxic or private data.</p>
<h2 id="specifying-custom-checkers">Specifying Custom Checkers</h2>
<p>We recommend to use or adapt the existing checkers where possible. However, if a custom checkers is required, there are two possibilities:</p>
<ol>
<li>Add the checker to the core of <code>lve-tools</code>. Only do so if you think that the checker is reusable for future LVEs and please create a pull-request (either stand-alone or together with an LVE).</li>
<li>Package your custom checker with your LVE.</li>
</ol>
<h3 id="checkers-as-part-of-lves">Checkers as part of LVEs</h3>
<p>A <code>single-file</code> checker can be defined inside <code>checker/checker.py</code> inside an LVE. For an example see <a href="/responsibility/copyright/songs/translation/openai--gpt-4">responsibility/copyright/songs/translation</a>.</p>
<h2 id="anatomy-of-a-checker">Anatomy of a Checker</h2>
<p>Each checker must extend <code>BaseChecker</code> (or <code>MultiRunBaseChecker</code>, respectively) and implement the function <code>is_safe</code> and optionally <code>postprocess_response</code>. The function <code>is_safe</code> is called with different args depending on the settings passed to the super-constructor <code>super().__init__(...)</code>.
As the first argument <code>is_safe</code> will always receive <code>prompt</code>, which is either just the input prompt specified by the user, or a prompt representing the full chat with the LLM reposes filled (depending on the value of <code>prompt_contains_responses</code>).
Additionally, if <code>get_response</code>, the variable <code>response</code> with the (last) response of the LLM is passed.
Lastly if <code>get_variables</code> is set, the variable <code>variables</code> is passed, which is a dictionary of all variables in the prompt (see <a href="/docs/technical/prompt/#multi-variable-prompts">Multi-Variable Prompts</a>).
In addition to these dynamic arguments, <code>is_safe</code> also receives a dictionary of the prompt parameters as <code>param_values</code>.
As a summary, arguments of the constructor with their respective default values are:</p>
<pre><code class="language-python">prompt_contains_responses=False, # wether to fill in the model responses in the prompt
get_variables=False, # wether to pass a dictionary of all variables to the checker
get_response=True # wether to pass the (last) model response to the checker
</code></pre>
<p>Based on the default values the default signature of <code>is_safe</code> is:</p>
<pre><code class="language-python">def is_safe(self, prompt: list[Message], response: str, param_values:dict[str, any] = None) -&gt; bool
</code></pre>
<p>For <code>MultiRunBaseChecker</code> the arguments to the constructor are the same.
The corresponding signature of <code>is_safe</code> is also similar, but <code>prompt</code>, <code>response</code>, and <code>variables</code> are lists of the respective instances.</p>
<h2 id="multi-variable-checkers">Multi-Variable Checkers</h2>
<p>In the case of <a href="/docs/technical/prompt/#multi-variable-prompts">Multi-Variable Prompts</a> multi-variable aware checkers must be used. Such checkers can be derived from <code>BaseChecker</code> (or <code>MultiRunBaseChecker</code>) by passing the correct arguments to the base <code>__init__</code> function. See <a href="#extending-basecheckers">Extending BaseCheckers</a> for details.</p>
<h2 id="multi-run-checkers">Multi-Run Checkers</h2>
<p>Checkers that operate on multiple runs for a single instance must extend <code>MultiRunBaseChecker</code>. The key checker functions <code>is_safe</code> and <code>postprocess_response</code> are called with the same arguments as before, but receive lists of these rather than single instances. Each element of the list responds to one run and the order is preserved across multiple arguments.</p>
        </div>
    </div>
    </div>
</body>
</html>